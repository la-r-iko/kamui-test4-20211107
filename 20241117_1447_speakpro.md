# 話し方レッスンWebサイト 機能要件定義書

## システムの目的

話し方レッスンWebサイトは、ユーザーが効果的な話し方を学ぶことを支援するオンラインプラットフォームです。ユーザーはレッスンの予約や教材のダウンロードを行うことができます。

## システムの特徴

- **限定的なユーザー登録**：管理者が指定したメールアドレスのみが登録可能
- **柔軟なレッスン予約**：5回レッスンおよび単発レッスンの提供
- **決済完了で予約確定**：決済が完了した時点で予約が確定
- **教材の簡単なアクセス**：Google Drive連携による教材ダウンロード機能

## 主要な機能要件

### サインイン機能

#### ユーザー登録

- **招待制登録**：管理者が事前に指定したメールアドレスのみが登録可能とする。
- **招待メール送信**：指定されたメールアドレスに招待メールを自動送信。
- **メール認証**：ユーザーは招待メール内のリンクをクリックし、メールアドレスの認証を行う。

#### 認証機能

- **ログイン認証**：Eメールアドレスとパスワードによるログイン機能を提供。
- **パスワード再設定**：パスワードを忘れた場合に備え、再設定機能を実装。

### 予約機能

#### 5回レッスン予約

- **一括・個別予約**：5回分のレッスンを一括または個別に予約可能。
- **スケジュール表示**：レッスンの空き状況をカレンダー形式で表示。
- **予約確定**：決済完了後に予約が確定し、ユーザーに確認メールを送信。

#### 単発レッスン予約

- **予約条件**：5回レッスンを全て完了したユーザーのみが予約可能。
- **日程選択**：単発レッスンのスケジュールを一覧表示し、希望の日時を選択。
- **予約確定**：決済完了後に予約が確定し、確認メールを送信。

### 予約変更機能

- **変更可能期間**：レッスンの3日前まで予約変更を許可。
- **変更手続き**：ユーザー自身がマイページから予約変更を行える。
- **確認通知**：変更後の予約内容を反映した確認メールを送信。

### 決済機能

#### 決済方法

- **クレジットカード決済**：主要なクレジットカードブランドに対応。
- **決済代行サービス統合**：StripeやPayPalなどの信頼性の高い決済代行サービスを利用。

#### 決済フロー

- **予約内容確認**：決済前に予約内容をユーザーに最終確認。
- **情報入力・認証**：必要な決済情報を入力し、認証処理を実施。
- **決済結果通知**：成功時は予約確定の通知、失敗時はエラーメッセージを表示。

### テキストダウンロード機能

- **Google Drive連携**：教材テキストをGoogle Drive上で管理。
- **教材一覧表示**：ユーザーにダウンロード可能な教材のリストを提供。
- **アクセス権限管理**：ユーザーごとに適切な教材へのアクセスを制御。

### 管理者機能

#### ユーザー管理

- **メールアドレス登録**：登録可能なメールアドレスの追加・削除機能。
- **ユーザー状況確認**：登録済みユーザーのアクティブ状況や最終ログイン日時を確認。

#### レッスン管理

- **スケジュール管理**：レッスンの新規作成、編集、削除を行える。
- **予約状況確認**：各レッスンの予約者数やキャンセル状況を確認。

#### 教材管理

- **教材アップロード**：新しい教材ファイルをGoogle Driveにアップロード。
- **教材整理**：教材のフォルダ分けや名前変更などの整理機能。
- **権限設定**：教材ごとにユーザーのアクセス権限を設定。

## 非機能要件

- **セキュリティ**

  - **認証・認可の徹底**：不正アクセス防止のための強固な認証・認可機能。
  - **通信の暗号化**：SSL/TLSによる全通信の暗号化を実施。
  - **脆弱性対策**：XSS、CSRF、SQLインジェクションなどへの対策を実装。

- **パフォーマンス**

  - **高速な応答性**：ページのロード時間を最適化し、快適な操作性を提供。
  - **負荷耐性**：同時アクセス時にも安定した動作を維持。

- **拡張性**

  - **モジュール設計**：機能の追加・修正が容易なモジュール化されたアーキテクチャ。
  - **技術選定**：将来の拡張を見据えた技術スタックの採用。

- **可用性**

  - **高可用性設計**：システムダウンタイムを最小限に抑える設計。
  - **バックアップ体制**：定期的なデータバックアップと迅速な復旧手順の確立。

## 開発・運用

### 開発環境

- **フロントエンド**

  - **Next.js**（推奨）
    - **Reactベース**：豊富なコンポーネントと拡張性。
    - **サーバーサイドレンダリング**：SEO最適化と高速なページ表示。
    - **TypeScript対応**：型安全性によるバグの早期発見。

- **バックエンド**

  - **FastAPI**（推奨）
    - **Pythonベース**：開発生産性の高さと豊富なライブラリ。
    - **高性能**：非同期処理による高速なAPIレスポンス。
    - **自動APIドキュメント**：OpenAPIによるドキュメントの自動生成。

- **データベース**

  - **リレーショナルデータベース**：データの整合性を保つため、PostgreSQLまたはMySQLを採用。

- **認証・認可**

  - **JWTトークン**：セキュアなセッション管理とスケーラブルな認証方式。

- **インフラ**

  - **クラウドサービス**：AWS、GCP、Azureのいずれかを利用し、信頼性と可用性を確保。
  - **コンテナ化**：Dockerによる環境の一貫性とデプロイの効率化。
  - **オーケストレーション**：Kubernetesの採用を検討し、スケーラビリティを確保。

- **CI/CDパイプライン**

  - **自動テスト**：コードの品質を保つためのユニットテストと統合テスト。
  - **自動デプロイ**：GitHub ActionsやGitLab CI/CDを利用した継続的インテグレーションとデプロイメント。

- **モニタリングとログ管理**

  - **状態監視**：PrometheusやGrafanaを使用してサーバーやアプリケーションの状態を可視化。
  - **ログ収集**：ELKスタックを活用し、ログの一元管理と分析を実施。

---